/*
Store a into a field element (fe10) into a bytestring
*/

#include "fe10.h"

void fe10_tobytes(uint8_t *s, fe10 *z)
{
    // Reduce x and y mod p
    fe10_reduce(z);

    // Store the values to `s`
    s[ 0]  = z->v[0];
    s[ 1]  = z->v[0] >>  8;
    s[ 2]  = z->v[0] >> 16;
    s[ 3]  = z->v[0] >> 24;
    s[ 3] += z->v[1] <<  2;
    s[ 4]  = z->v[1] >>  6;
    s[ 5]  = z->v[1] >> 14;
    s[ 6]  = z->v[1] >> 22;
    s[ 6] += z->v[2] <<  3;
    s[ 7]  = z->v[2] >>  5;
    s[ 8]  = z->v[2] >> 13;
    s[ 9]  = z->v[2] >> 21;
    s[ 9] += z->v[3] <<  5;
    s[10]  = z->v[3] >>  3;
    s[11]  = z->v[3] >> 11;
    s[12]  = z->v[3] >> 19;
    s[12] += z->v[4] <<  6;
    s[13]  = z->v[4] >>  2;
    s[14]  = z->v[4] >> 10;
    s[15]  = z->v[4] >> 18;
    s[16]  = z->v[5];
    s[17]  = z->v[5] >>  8;
    s[18]  = z->v[5] >> 16;
    s[19]  = z->v[5] >> 24;
    s[19] += z->v[6] <<  1;
    s[20]  = z->v[6] >>  7;
    s[21]  = z->v[6] >> 15;
    s[22]  = z->v[6] >> 23;
    s[22] += z->v[7] <<  3;
    s[23]  = z->v[7] >>  5;
    s[24]  = z->v[7] >> 13;
    s[25]  = z->v[7] >> 21;
    s[25] += z->v[8] <<  4;
    s[26]  = z->v[8] >>  4;
    s[27]  = z->v[8] >> 12;
    s[28]  = z->v[8] >> 20;
    s[28] += z->v[9] <<  6;
    s[29]  = z->v[9] >>  2;
    s[30]  = z->v[9] >> 10;
    s[31]  = z->v[9] >> 18;
}
