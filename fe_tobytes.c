/*
Store a into a field element (fe) into a bytestring
*/

#include "fe.h"

void fe_tobytes(uint8_t *s, fe z)
{
    // Reduce x and y mod p
    fe_reduce(z);

    // Store the values to `s`
    s[ 0]  = z[0];
    s[ 1]  = z[0] >>  8;
    s[ 2]  = z[0] >> 16;
    s[ 3]  = z[0] >> 24;
    s[ 3] += z[1] <<  2;
    s[ 4]  = z[1] >>  6;
    s[ 5]  = z[1] >> 14;
    s[ 6]  = z[1] >> 22;
    s[ 6] += z[2] <<  3;
    s[ 7]  = z[2] >>  5;
    s[ 8]  = z[2] >> 13;
    s[ 9]  = z[2] >> 21;
    s[ 9] += z[3] <<  5;
    s[10]  = z[3] >>  3;
    s[11]  = z[3] >> 11;
    s[12]  = z[3] >> 19;
    s[12] += z[4] <<  6;
    s[13]  = z[4] >>  2;
    s[14]  = z[4] >> 10;
    s[15]  = z[4] >> 18;
    s[16]  = z[5];
    s[17]  = z[5] >>  8;
    s[18]  = z[5] >> 16;
    s[19]  = z[5] >> 24;
    s[19] += z[6] <<  1;
    s[20]  = z[6] >>  7;
    s[21]  = z[6] >> 15;
    s[22]  = z[6] >> 23;
    s[22] += z[7] <<  3;
    s[23]  = z[7] >>  5;
    s[24]  = z[7] >> 13;
    s[25]  = z[7] >> 21;
    s[25] += z[8] <<  4;
    s[26]  = z[8] >>  4;
    s[27]  = z[8] >> 12;
    s[28]  = z[8] >> 20;
    s[28] += z[9] <<  6;
    s[29]  = z[9] >>  2;
    s[30]  = z[9] >> 10;
    s[31]  = z[9] >> 18;
}
